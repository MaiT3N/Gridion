!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Gridion=t():e.Gridion=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=2)}([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(5),l=i(s),a=n(6),u=i(a),f=n(7),c=i(f),d=function(){function e(){o(this,e)}return r(e,null,[{key:"Animation",get:function(){return l.default}},{key:"Transition",get:function(){return u.default}},{key:"teOnce",get:function(){return c.default}}]),e}();t.default=d},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(){i(this,e)}return o(e,[{key:"createElement",value:function(e){this.el=this.stringToElement(e)}},{key:"stringToElement",value:function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstChild}},{key:"appendTo",value:function(e){this.parent=document.querySelector(e),this.parent.appendChild(this.el)}},{key:"remove",value:function(){this.el.parentNode.removeChild(this.el)}}]),e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),o=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=o.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(4),l=i(s),a=n(0),u=i(a),f=n(8),c=i(f),d=n(11),h=i(d),v=function(){function e(t,n){var i=this;o(this,e),this.parent=document.querySelector(t),this.view=new c.default,this.appendToParent(),this.model=new h.default(this.view.el.offsetWidth,n);var r=void 0;window.addEventListener("resize",function(){clearTimeout(r),r=setTimeout(function(){i.model.updateSize(i.view.el.offsetWidth),i.model.list.forEach(function(e){e.model.updateSize(i.model.size)}),i.fastUpdate()},100)})}return r(e,[{key:"appendToParent",value:function(){this.parent.appendChild(this.view.el)}},{key:"fastAddItem",value:function(e,t){var n=this.model.addItem(e,t);this.view.addItem(n.view.el),this.fastUpdate()}},{key:"fastAddItems",value:function(e,t){var n=this;if(!(e instanceof Array))throw new TypeError("list is not an array");this.model.addItems(e,t).forEach(function(e){n.view.addItem(e.view.el)}),this.fastUpdate()}},{key:"fastRemoveItem",value:function(e){this.model.removeItem(e)}},{key:"fastUpdate",value:function(){this.model.list.forEach(function(e){e.updateSize(),e.updatePosition()});var e=this.model.table.cells.length;this.view.setHeight(e*this.model.size)}},{key:"addItems",value:function(e,t,n){if(!(e instanceof Array))throw new TypeError("list is not an array");var i=this.model.addItems(e,t),o=this.model.table.cells.length;this.view.setHeight(o*this.model.size),n=n||function(){},new u.default.Animation(l.default.positioning.simpleTranslate(this,this.model.differences)).then(l.default.add.scaleMax(this,i)).run(n)}},{key:"removeItem",value:function(e,t){var n=this,i=this.model.removeItem(e);t=t||function(){},new u.default.Animation(l.default.remove.scaleMin(this,[i])).then(l.default.positioning.simpleTranslate(this,this.model.differences)).run(function(){var e=n.model.table.cells.length;n.view.setHeight(e*n.model.size),t()})}},{key:"scaleItem",value:function(e,t,n,i){var o=this,r=this.model.scaleItem(e,t,n);i=i||function(){},new u.default.Animation(l.default.scaling.scaleMin(this,[r])).then(l.default.positioning.simpleTranslate(this,this.model.differences)).then(l.default.scaling.scaleMax(this,[r])).run(function(){var e=o.model.table.cells.length;o.view.setHeight(e*o.model.size),i()})}}]),e}();t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default={add:{fadeOut:function(e,t){return new o.default.Transition(function(){t.forEach(function(t){t.view.el.classList.add("is-fade"),e.view.addItem(t.view.el),t.updateSize(),t.updatePosition()})},function(){t.forEach(function(t){t.view.el.classList.add("is-fading"),e.view.addItem(t.view.el)})},function(e){var n=t.length;0!==n?t.forEach(function(t){o.default.teOnce(t.view.el,function(){t.view.el.classList.remove("is-fading"),e&&!--n&&e()}),t.view.el.classList.remove("is-fade")}):e&&e()},function(){})},scaleMax:function(e,t){return new o.default.Transition(function(){t.forEach(function(t){t.view.el.classList.add("is-scaling"),e.view.addItem(t.view.el),t.updateSize(),t.updatePosition()}),t.forEach(function(e){e.view.transforms.addToElement(e.view.el,{scale:["0"]})})},function(){},function(e){var n=t.length;0!==n?t.forEach(function(t){o.default.teOnce(t.view.el,function(){!--n&&e&&e()}),t.view.transforms.addToElement(t.view.el,{scale:["1"]})}):e&&e()},function(){t.forEach(function(e){e.view.el.classList.remove("is-scaling")})})}},remove:{scaleMin:function(e,t){return new o.default.Transition(function(){t.forEach(function(e){e.view.el.classList.add("is-scaling")})},function(){t.forEach(function(e){e.view.transforms.addToElement(e.view.el,{scale:["1"]})})},function(e){var n=t.length;0!==n?t.forEach(function(t){t.view.transforms.addToElement(t.view.el,{scale:["0"]}),t.view.el.addEventListener("transitionend",function(){!--n&&e&&e(),t.view.el.remove()})}):e&&e()},function(){})}},positioning:{simpleTranslate:function(e,t){return new o.default.Transition(function(){},function(){},function(e){var n=t.length;0!==n?t.forEach(function(t){o.default.teOnce(t.view.el,function(){!--n&&e&&e()}),t.updateSize(),t.updatePosition()}):e&&e()},function(){})}},scaling:{scaleMax:function(e,t){return new o.default.Transition(function(){t.forEach(function(e){e.view.el.classList.add("is-scaling"),e.updateSize(),e.updatePosition()})},function(){t.forEach(function(e){e.view.transforms.addToElement(e.view.el,{scale:["0"]})})},function(e){var n=t.length;0!==n?t.forEach(function(t){t.view.transforms.addToElement(t.view.el,{scale:["1"]}),o.default.teOnce(t.view.el,function(){!--n&&e&&e()})}):e&&e()},function(){})},scaleMin:function(e,t){return new o.default.Transition(function(){t.forEach(function(e){e.view.el.classList.add("is-scaling")})},function(){t.forEach(function(e){e.view.transforms.addToElement(e.view.el,{scale:["1"]})})},function(e){var n=t.length;0!==n?t.forEach(function(t){t.view.transforms.addToElement(t.view.el,{scale:["0"]}),t.view.el.addEventListener("transitionend",function(){!--n&&e&&e()})}):e&&e()},function(){})}}}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(t){i(this,e),this.list=[t]}return o(e,[{key:"then",value:function(e){return this.list.push(e),this}},{key:"run",value:function(e){for(var t=this.list[this.list.length-1].run.bind(this.list[this.list.length-1],e),n=this.list.length-2;n>=0;n--)t=this.list[n].run.bind(this.list[n],t);t()}}]),e}();t.default=r},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(t,n,o,r){i(this,e),this.prepare=t,this.start=n,this.finish=o,this.ending=r}return o(e,[{key:"run",value:function(e){var t=this;this.prepare(),requestAnimationFrame(function(){t.start(),requestAnimationFrame(function(){t.finish(function(){t.ending(),e&&e()})})})}}]),e}();t.default=r},function(e,t,n){"use strict";function i(e,t){var n=function n(){e.removeEventListener("transitionend",n),t()};e.addEventListener("transitionend",n)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();n(9);var a=n(10),u=i(a),f=n(1),c=i(f),d=function(e){function t(){o(this,t);var e=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.grid=e.createElement((0,u.default)()),e}return s(t,e),l(t,[{key:"addItem",value:function(e){this.el.appendChild(e)}},{key:"addItemAnimated",value:function(e){this.el.appendChild(e)}},{key:"setHeight",value:function(e){this.el.style.height=e+"px"}},{key:"clear",value:function(){this.el.innerHTML=""}}]),t}(c.default);t.default=d},function(e,t){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return'<div class="gridion"></div>'}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(12),l=i(s),a=n(17),u=i(a),f=function(){function e(t,n){o(this,e),this.size=parseFloat(t)/n,this.w=n,this.list=[],this.table=new u.default(n),this.ids=[],this.differences=[]}return r(e,[{key:"updateSize",value:function(e){this.size=parseFloat(e)/this.w}},{key:"genId",value:function(){var e=this.ids.length+1;return this.ids.push(e),e}},{key:"addItem",value:function(e,t){var n=new l.default(e);return t||0===t&&t<this.list.length||(t=this.list.length),n.setId(this.genId()),n.model.size=this.size,this.list.splice(t,0,n),this.table.remove(),this.table.addCells(this.list),this.setDifferences(),n}},{key:"addItems",value:function(e,t){var n=this,i=[];return t||0===t&&t<this.list.length||(t=this.list.length),e.forEach(function(e){var t=new l.default(e,n.genId());t.model.size=n.size,i.push(t)}),this.list.splice.bind(this.list,t,0).apply(this.list,i),this.table.remove(),this.table.addCells(this.list),this.setDifferences(),i}},{key:"setDifferences",value:function(){var e=this;this.differences=[],this.list.forEach(function(t){(t.model.y!==t.model.yOld&&null!==t.model.yOld||t.model.x!==t.model.xOld&&null!==t.model.xOld)&&(e.differences.push(t),t.model.setOldPosition())})}},{key:"removeItem",value:function(e){var t=this.list.find(function(t){return t.model.id===e}),n=this.list.indexOf(t);return this.list.splice(n,1),this.table.remove(),this.table.addCells(this.list),this.setDifferences(),t}},{key:"scaleItem",value:function(e,t,n){var i=this.list.find(function(t){return t.model.id===e});return t+i.model.x>this.table.w&&(t=this.table.w-i.model.x),i.model.w=t,i.model.h=n,this.table.scaleCell(e,t,n,this.list),this.setDifferences(),i}}]),e}();t.default=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(13),l=i(s),a=n(16),u=i(a),f=function(){function e(t,n){o(this,e),this.model=new this.constructor.Model(t.size,t.pos),this.view=new this.constructor.View(t.data),this.setId(n),t.buildCallback&&t.buildCallback(this)}return r(e,[{key:"updatePosition",value:function(){this.view.setPosition(this.model.x*this.model.size,this.model.y*this.model.size)}},{key:"updateSize",value:function(){this.view.setSize(this.model.w*this.model.size,this.model.h*this.model.size)}},{key:"setId",value:function(e){this.model.id=e}}],[{key:"Model",get:function(){return u.default}},{key:"View",get:function(){return l.default}}]),e}();t.default=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(14),u=i(a),f=n(1),c=i(f),d=n(15),h=i(d),v=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.createElement((0,u.default)(e)),n.transforms=new h.default({scale:["1"]}),n.transforms.setPriority(["translate","scale"]),n}return s(t,e),l(t,[{key:"setPosition",value:function(e,t){this.transforms.addToElement(this.el,{translate:[e+"px",t+"px"]})}},{key:"setSize",value:function(e,t){this.el.style.width=e+"px",this.el.style.height=t+"px"}},{key:"animatedRemove",value:function(e){var t=this;this.el.classList.add("is-scaling"),this.transforms.addToElement(this.el,{scale:["0"]}),this.el.addEventListener("transitionend",function(){t.remove(),e&&e()})}}]),t}(c.default);t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return'<div class="gridion__cell">'+e+"</div>"}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(t){i(this,e),this.props={},this.priority=[],this.set(t)}return o(e,[{key:"set",value:function(e){"string"==typeof e?this.setFromString(e):e&&this.setFromObject(e)}},{key:"setFromString",value:function(e){var t=this;e.match(/\w+\([^\(]*\)/g).forEach(function(e){var n=e.match(/\w+/)[0];t.props[n]=e.match(/\((.*)\)/)[1].split(",")})}},{key:"setFromObject",value:function(e){for(var t in e)this.props[t]=e[t]}},{key:"setPriority",value:function(e){this.priority=e}},{key:"addToElement",value:function(e,t,n){var i=this;n&&this.setPriority(n),t&&this.set(t);var o="";this.priority.forEach(function(e){e in i.props&&(o+=" "+e+"("+i.props[e]+")")});for(var r in this.props){(function(e){if(i.priority.some(function(t){return t===e}))return"continue";var t="";i.props[e].forEach(function(e){t+=","+e}),t=t.slice(1),o+=" "+e+"("+i.props[e]+")"})(r)}e.style.transform=o.slice(1)}}]),e}();t.default=r},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(t,n){i(this,e),this.size=null,this.id=null,this.w=t.w,this.h=t.h,this.x=null,this.y=null,this.xOld=null,this.yOld=null}return o(e,[{key:"updateSize",value:function(e){this.size=e}},{key:"setPosition",value:function(e,t){this.x=e,this.y=t}},{key:"setOldPosition",value:function(){this.xOld=this.x,this.yOld=this.y}}]),e}();t.default=r},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(t){i(this,e),this.cells=[],this.w=t,this.h=0}return o(e,[{key:"generate",value:function(){for(var e=0;e<this.h;e++){this.cells[e]=[];for(var t=0;t<this.w;t++)this.cells[e][t]=0}}},{key:"clear",value:function(){this.generate()}},{key:"remove",value:function(){this.cells=[],this.h=0}},{key:"addCell",value:function(e){for(;!this.checkReceivingCell(e.model.h);)this.createNewRow();for(var t={x:0,y:0};t.y<this.cells.length;t.y++){for(;t.x<this.cells[t.y].length;){if(this.checkFreeSpace(e,t))return this.setCell(e,t),t;t.x++}t.x=0,t.y+e.model.h>this.h-1&&this.createNewRow()}}},{key:"setCell",value:function(e,t){for(var n=t.y;n<e.model.h+t.y;n++)for(var i=t.x;i<e.model.w+t.x;i++)this.cells[n][i]=e.model.id}},{key:"createNewRow",value:function(){var e=this.h;this.cells[e]=[];for(var t=0;t<this.w;t++)this.cells[e][t]=0;this.h++}},{key:"checkFreeSpace",value:function(e,t){if(e.model.h+t.y>this.h||e.model.w+t.x>this.w)return!1;for(var n=t.y;n<e.model.h+t.y;n++)for(var i=t.x;i<e.model.w+t.x;i++)if(this.cells[n][i])return!1;return!0}},{key:"checkReceivingCell",value:function(e){return this.h>=e}},{key:"addCells",value:function(e){for(var t=0;t<e.length;t++){var n=this.addCell(e[t]);e[t].model.setOldPosition(),e[t].model.setPosition(n.x,n.y)}}},{key:"scaleCell",value:function(e,t,n,i){this.remove();for(var o=void 0,r=[],s=0;s<i.length;s++)i[s].model.id!==e?r.push(i[s]):o=i[s];for(var l=0;l<o.model.y+o.model.h;l++)this.createNewRow();this.setCell(o,{x:o.model.x,y:o.model.y}),this.addCells(r)}}]),e}();t.default=r}]).default});